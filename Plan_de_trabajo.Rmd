---
title: "Montaje de los archivos de entrada al modelo SS3, formatos requeridos y aprovechamiento si fuera
posible de los utilizados en las entradas de a4a."
author: " "
date: '`r format(Sys.Date(),"%B, %d, %Y")`'
output: 
  pdf_document:
   toc: TRUE
   number_sections: yes
urlcolor: blue   
---

\newpage

# Contexto

Se pretende desarrollar un modelado con Stock Synthesis de los stocks de merluza europea (*Merluccius merluccius*) de la GSA1 (mar de Alborán) y GSA6 (Levante-Norte de España). Ambos stocks se encuentran definidos en el GFCM en el Mediterráneo español y llevan varios años siendo evaluados con metodología analítica SCAA utilizando el modelo **a4a**, con evaluaciones validadas y aprobadas en el GFCM en los últimos años. Se trabajaría con la serie histórica actualizada en el último WGSAD de diciembre de 2022 (2002-2021).

Los dos objetivos principales  serían por un lado Intentar testar el paso de un modelo **SCAA** a uno integrado en el entorno **GFCM** con stocks españoles, algo hasta el momento inédito, y por otro lado presentar los resultados al próximo Simposio de Modelado y Evaluación de Recursos Pesqueros (SIMERPE II) que se celebrará en Cádiz desde el 24 al 27 de octubre de 2023.




# Tareas a desarrollar.

Dentro de la propuesta se han identificado las posibles tareas a desarrollar que serían por orden cronológico:

 1.	Montaje de los archivos de entrada al modelo SS3, formatos requeridos y aprovechamiento si fuera posible de los utilizados en las entradas de a4a.
 2.	Identificar tareas adicionales que requieran una recopilación de datos de entrada extra o con formatos diferentes a los usados en a4a.
 3.	Puesta a punto de ficheros de entrada SS3.
 4.	Primeras rodadas tentativas.
 5.	Análisis de resultados. Comparación con salidas XSA y a4a.
 6.	Presentación de los resultados en el SIMERPE II
 7.	Estudio de la viabilidad y/o idoneidad de estructurar la evaluación con estos stocks usando Stock Synthesis para los grupos de trabajo del GFCM el año que viene (WGSAD 2023).


# Temporalización y dinámica de las actividades propuestas.

El flujo de trabajo tendría tres fases bien definidas, una inicial en la cual de forma telemática se completarían los puntos 1, 2 y 3 de la propuesta. Se propone completar esta fase antes del 31 de marzo de 2023.

En una segunda fase de desarrollo, se realizarían las primeras rodadas tentativas y se adquirirían las competencias necesarias para rodar el modelo de forma autónoma, al menos en sus requerimientos más básicos. Esta fase se realizaría en el C.O de Cádiz y Encarnación García y José Luis Pérez se desplazarían a este centro para tal fin para trabajar con María José Zúñiga bajo la supervisión de Margarita Rincón. Esta segunda fase tendría que estar completada el 30 de abril.

En una última fase se analizarían telemáticamente los resultados obtenidos y la viabilidad e idoneidad del paso de a4a a Stock Synthesis para los dos stocks evaluados. Esta fase tendría dos fechas diferenciadas, una a final de mayo para confeccionar y enviar los resultados al SIMERPE II y otra en noviembre para dejar lista la evaluación de ambos stocks para su posible presentación en el WGSAD-GFCM en diciembre de 2023.


# Análisis de datos de los stocks de merluza europea (*Merluccius merluccius*) de la GSA1 (mar de Alborán) y GSA6 (Levante-Norte de España).


```{r global-options, include=FALSE}
knitr::opts_chunk$set(echo=T, warning=FALSE, message=FALSE,collapse=TRUE,fig.align="center",fig.pos="h!")
```



```{r results='hide',include=FALSE}
## Librerías requeridas
 paquetes <- c("stringr", "tidyverse", "kableExtra","ggplot2","ggthemes",
               "patchwork","dplyr","reshape","here","r4ss")
 lapply(paquetes, require, character.only = TRUE)
```

## Leer datos formato a4a

El modelo SCAA a4a está implementado en FLR  (https://flr-project.org/doc/Loading_your_data_into_FLR.html
, por lo tanto la arquitectura de sus ficheros imput sigue se estructura en torno a la clase FLStock con los siguientes slots:

 - Catch
 - catch.n
 - catch.wt
 - discards
 - discards.n
 - discards.wt
 - landings
 - landings.n
 - landings.wt
 - stock
 - stock.n
 - stock.wt
 - m
 - mat
 - harvest
 - harvest.spwn
 - m.spwn

No obstante, para facilitar la importación de los archivos imput, usamos ficheros con formato .DAT que mediante el archivo índice “LOWIND.DAT” y la sentencia “stk <- readFLStock("LOWIND.DAT")”, nos lee nuestros ficheros creándonos el objeto FLStock.

A continuación describimos brevemente cada uno de los archivos .DAT que usamos como imputs:

- CATCH: Capturas anuales del stock (En nuestro caso GSA correspondiente). Toneladas.
- CATNUM: Matriz de número de individuos por edad/año de las capturas. (Miles de individuos).
- CATWT: Peso medio por edad y año de tu matriz de captura. (Kilos).
- STOCWT: medio por edad y año asumida para el stock (Normalmente = CATWT). (Kilos).
- TUNEFF: Fichero con los índices de abundancia para calibrar (CPUEs o Campañas, o ambas). Normalmente para índices de campaña empleamos número/KM2.
- NATMOR: Vector de mortalidad Natural por edad.
- PROPMAT: Ogiva de madurez por edad.
- PROPM:Factor de proporcionalidad de M antes de la puesta. Sería el slot m.spwn. Normalmente computamos 0.5 si la puesta es alrededor de Junio.
- PROPF: Factor de proporcionalidad de F antes de la puesta. Sería el slot harvest.spwn. Normalmente computamos 0.5 si la puesta es alrededor de Junio.
- LOWIND: Fichero índice.
- INCHECK: Este no es un fichero imput propiamente dicho. Se trata del fichero resumen tras realizar el slicing con el programa L2age. Se recogen aquí el set de parámetros de crecimiento utilizados.

\newpage

### GSA1 (mar de Alborán)

#### Modelo conceptual
\quad
La conceptualización del modelo biológico de **GSA1** considera los siguientes componentes de la dinámica poblacional:

 - Estructura geográfica
 - Reproducción
 - Reclutamiento
 - Mortalidad natural
 - Crecimiento
 - otros...


#### Descripción del modelo
\quad
El modelo de evaluación de stock de **GSA1** se basa en un análisis estadístico de la dinámica de estructuras de edad anual que incorpora información biológica y pesquera. La información que ingresa al modelo consiste en ... 

- Años de evaluación de stock = 2003_2021
- número de edades = 6 años ?


#### Archivos utilizado para enfoque de modelación `a4a`
\quad
```{r}
dir_GSA1 <-  here("hke-GSA1-a4a_ format")
dir(dir_GSA1)
```

#### Archivos utilizado para enfoque de modelación `SS3`
1. Identificamos el directorio donde se encuentra el modelo base simple
```{r}
dirname.base <- here("simple")
```

3. Creamos un nuevo directorio para la nueva versión del modelo modificado 
```{r}
dirname.simple_mod <- here("GSA6_SS3")
dir.create(path=dirname.simple_mod, showWarnings = TRUE, recursive = TRUE)
```

5. Copiamos los archivos para el modelo que vamos a  modificar
```{r}
copy_SS_inputs(dir.old = dirname.base, 
               dir.new = dirname.simple_mod,
               copy_exe = TRUE,
               verbose = FALSE)
```

### Información general del modelo

En la parte superior se especifica información general del modelo: los años del modelo, número de temporadas, número de sexos, edad máxima, número de áreas, número de flotas  

[Consulte la Guía de usuario de SS3: Sección 7.5 "Model Dimensions"](https://nmfs-stock-synthesis.github.io/doc/SS330_User_Manual.html#model-dimensions).


Revisamos los nombres de los componentes de la lista del archivo .dat
```{r}

dat <- r4ss::SS_readdat(here(dirname.base,"data.ss")) #base
dat1<-dat # para modificar
#names(dat1) 
```


```{r}
#Especificaciones iniciales
dat1$styr           <-1971  #_StartYr
dat1$endyr          <-2001  #_EndYr
dat1$nseas          <-1     #_Nseas
dat1$months_per_seas<-12    #_months/season
dat1$Nsubseasons    <-2     #_Nsubseasons (even number, minimum is 2)
dat1$spawn_month    <-1     #_spawn_month
dat1$Ngenders       <-2     #_Ngenders: 1, 2, -1  (use -1 for 1 sex setup with SSB multiplied by 
#female_frac parameter)
dat1$Nages          <-40    #_Nages=accumulator age, first age is always age 0
dat1$N_areas        <-1     #_Nareas
dat1$Nfleets        <-3     #_Nfleets (including surveys)
```




#### Capturas anuales del stock (toneladas)
\quad

1. formato a4a
```{r}
dir(dir_GSA1)[1]
  CATCH.DAT <- read.table(paste(dir_GSA1,dir(dir_GSA1)[1],sep="/"),
                          header=T,sep="",na="NA",fill=T,skip = 4)
  CATCH.DAT
  
```


2. formato SS3

Primero ingresamos las especificaciones de los Datos de captura de la flota

```{r}
#_fleet_type: 1=catch fleet; 2=bycatch only fleet; 3=survey; 4=ignore 
#_sample_timing: -1 for fishing fleet to use season-long catch-at-age for 
#observations, or 1 to use observation month;  (always 1 for surveys)
#_fleet_area:  area the fleet/survey operates in 
#_units of catch:  1=bio; 2=num (ignored for surveys; their units read later)
#_catch_mult: 0=no; 1=yes
#_rows are fleets
#_fleet_type fishery_timing area catch_units need_catch_mult fleetname

# Modificar con los datos propios
fleetnames1    <-c("FISHERY", "SURVEY1", "SURVEY2")     #character vector
surveytiming1  <-c(-1,1,1)#numeric vector
units_of_catch1<-c(1,2,2) #numeric vector
areas1         <-c(1,1,1) #numeric vector

# crear data.frame para fleetinfo
fleetinfo1<-data.frame(type = c(1,3,3),
                       surveytiming =surveytiming1,
                       area=areas1,
                       units=units_of_catch1,
                       need_catch_mult =c(0,0,0),
                       fleetname=fleetnames1)

dat1$fleetinfo     <- fleetinfo1      #data.frame
dat1$fleetinfo

```

A continuación, se especifica la captura. 

[Consulte la Guía de usuario de SS3: Sección 7.9 "Catch"](https://nmfs-stock-synthesis.github.io/doc/SS330_User_Manual.html#catch).

```{r}
#_Catch data: yr, seas, fleet, catch, catch_se
#_catch_se:  standard error of log(catch)
#_NOTE:  catch data is ignored for survey fleets

# Datos de modelo simple
year<-1971:2001
nyear<-length(year)
catch_year<-c(-999,year)
catch_seas<-rep(1,nyear+1)
catch_fleet<-rep(1,nyear+1)
catch_catch<-dat$catch$catch #datos ss3 reemplazar por datos gsa1
catch_catch_se<-rep(0.01,nyear+1)

# Modificar con los datos propios
catch1<-data.frame(year=catch_year,
                   seas=catch_seas,
                   fleet=catch_fleet,
                   catch=catch_catch,
                   catch_se=catch_catch_se)
dat1$catch<-catch1 # data.frame
dat1$catch

```

- La primera línea del fragmento de código anterior muestra los encabezados de columna para los datos de captura. 

- Tenga en cuenta que toda la captura proviene de la pesquería. La línea `-999 1 1 0 0.01` especifica la captura  de equilibrio para los años anteriores al inicio del modelo; en este caso, no hay captura de equilibrio porque la columna de captura es 0.


\newpage

#### índices de abundancia para calibrar (CPUEs o Campañas, o ambas). Normalmente para índices de campaña empleamos número/KM2.
\quad
1. formato a4a
```{r}
dir(dir_GSA1)[12]
  TUNEFF.DAT <- read.table(paste(dir_GSA1,dir(dir_GSA1)[12],sep="/"),
                           sep="",na="NA",fill=T,skip = 6)
  TUNEFF.DAT
  
```

2. formato SS3

Luego viene la especificación de los índices de abundancia.  Primero está la configuración para todas las flotas. 

[Consulte la Guía de usuario de SS3: Sección 7.10 "Indices"](https://nmfs-stock-synthesis.github.io/doc/SS330_User_Manual.html#indices).

```{r}
#_CPUE_and_surveyabundance_observations
#_Units:  0=numbers; 1=biomass; 2=F; >=30 for special types
#_Errtype:  -1=normal; 0=lognormal; >0=T
#_SD_Report: 0=no sdreport; 1=enable sdreport
#_Fleet Units Errtype SD_Report

# Datos de modelo simple
CPUEinfo_Fleet    <-c(1,2,3)
CPUEinfo_Units    <-c(1,1,0)
CPUEinfo_Errtype  <-c(0,0,0)
CPUEinfo_SD_Report<-c(0,1,0)
CPUEinfo_names    <-c("FISHERY", "SURVEY1", "SURVEY2")

# Modificar con los datos propios
CPUEinfo1<-data.frame(Fleet=CPUEinfo_Fleet,
                      Units=CPUEinfo_Units,
                      Errtype=CPUEinfo_Errtype,
                      SD_Report=CPUEinfo_SD_Report)

row.names(CPUEinfo1)<-CPUEinfo_names

dat1$CPUEinfo<-CPUEinfo1 # data.frame
dat1$CPUEinfo
```

- Los encabezados de las columnas de esta sección están directamente encima de los números. Tenga en cuenta que aquí se definen todas las flotas (es decir, cada flota necesita una línea), incluida la pesquería, y se enumeran en el mismo orden que cuando se especificaron los tipos de flota.

- Lo más importante en esta sección es que se especifican las unidades y el tipo de error que se utilizará al leer los índices de abundancia. 

- En este caso, la pesquería y la campaña 1 tienen unidades de biomasa, mientras que la campaña 2 es en números. Se asume un error logarítmico normal para las 3 flotas.

- Inmediatamente después de su encabezado, se incluyen los datos de índices de abundancia:

```{r}
# Datos de modelo simple
yearf1<-c(seq(1977,1998,3),2001)
yearf2<-seq(1990,2001,1)

CPUE_year   <-c(yearf1,yearf2)
CPUE_seas   <-rep(7,length(CPUE_year))
CPUE_index  <-c(rep(2,length(yearf1)),rep(3,length(yearf2)))
CPUE_obs    <-dat$CPUE$obs 
CPUE_se_log <-c(rep(0.3,length(yearf1)),rep(0.7,length(yearf2)))

# Modificar con los datos propios
CPUE1<-data.frame(year=CPUE_year,
                  seas=CPUE_seas,
                  index=CPUE_index,
                  obs=dat$CPUE$obs,
                  se_log=CPUE_se_log)

dat1$CPUE<-CPUE1 # data.frame
dat1$CPUE
```

### Descartes y tallas medias

A continuación, se podrían especificar los datos de descartes y tallas media, pero son 0 en este ejemplo. 

[Consulte la Guía de usuario de SS3: Sección 7.11 "Discard"](https://nmfs-stock-synthesis.github.io/doc/SS330_User_Manual.html#discard).


```{r}
# Modificar con los datos propios
dat1$N_discard_fleets <-0 #numeric
dat1$use_meanbodywt   <-0 #numeric
```

### Composición de tallas

La siguiente sección configura los intervalos de talla (`length bin`) de la población. 

Esto debe especificarse ya sea que se utilicen o no datos de composiciones de tallas (aunque podría generar los intervalos de longitud de la población a partir de los intervalos de datos de composiciones de tallas). 

[Consulte la Guía de usuario de SS3: Sección 7.14 "Length Composition Data Structure"](https://nmfs-stock-synthesis.github.io/doc/SS330_User_Manual.html#length-composition-data-structure).

```{r}
# set up population length bin structure (note - irrelevant if not using size 
#data and using empirical wtatage

# Modificar con los datos propios
dat1$lbin_method  <-2 # length bin method:1=use databins; 
                      # 2=generate from binwidth,min,max below;
                      # 3=read vector
dat1$binwidth     <-2  # binwidth for population size comp 
dat1$minimum_size <-10 # minimum size in the population 
                       # (lower edge of first bin and size at age 0.00) 
dat1$maximum_size <-94 # maximum size in the population (lower edge of last bin) 
dat1$use_lencompz <-1  # use length composition data (0/1)
```

Después de los intervalos de tallas de la población está la especificación para la composición de tallas (asumiendo 1 línea por flota):

```{r}

len_info_mintailcomp   <-rep(0,3)
len_info_addtocomp     <-rep(1e-07,3)
len_info_combine_M_F   <-rep(0,3)
len_info_CompressBins  <-rep(0,3)
len_info_CompError     <-rep(0,3)
len_info_ParmSelect    <-rep(0,3)
len_info_minsamplesize <-rep(1,3)

# Modificar con los datos propios
len_info1 <- data.frame(mintailcomp=len_info_mintailcomp,
                        addtocomp=len_info_addtocomp,
                        combine_M_F=len_info_combine_M_F,
                        CompressBins=len_info_CompressBins,
                        CompError=len_info_CompError,
                        ParmSelect=len_info_ParmSelect,
                        minsamplesize=len_info_minsamplesize)

row.names(len_info1)<-c("FISHERY", "SURVEY1", "SURVEY2")

dat1$len_info   <- len_info1 #data.frame
dat1$len_info

```

La especificación del vector de tallas:

```{r}
# Modificar con los datos propios
dat1$N_lbins     <-25  #numeric
dat1$lbin_vector <-c(seq(26,64,2),seq(68,80,4),90) #numeric vector

```

Y luego los datos de composición de tallas:

```{r}

# separar por sexo !!!!!

# Modificar con los datos propios
new_lencomp_flt_1 <- data.frame(Yr = 2002:2021, 
                                Seas = 7, 
                                FltSvy = -1, 
                                Gender = 3, 
                                Part = 0, 
                                Nsamp = 125)

new_lencomp_flt_2 <- data.frame(Yr = seq(2002, 2021, by = 3), 
                                Seas = 7, 
                                FltSvy = -2, 
                                Gender = 3, 
                                Part = 0, 
                                Nsamp = 125)

dat_rows_names <- colnames(dat$lencomp)[-(1:6)]
dat_rows <- as.data.frame(matrix(data = 1, nrow = nrow(new_lencomp_flt_1)+nrow(new_lencomp_flt_2), 
                   ncol = length(dat_rows_names)))
names(dat_rows) <- dat_rows_names 


new_lencomp <- rbind(new_lencomp_flt_1, new_lencomp_flt_2)
new_lencomp <- cbind(new_lencomp, dat_rows)

dat1$lencomp <- rbind(dat$lencomp, new_lencomp) #data.frame
```

En este modelo de 2 sexos, los datos de composición de tallas se introducen para las hembras, con 1 número por intervalo de tallas especificado previamente, seguido de los datos de composición de tallas para los machos, también con 1 número por intervalo de tallas.


\newpage

#### Matriz de número de individuos por edad/año de las capturas (Miles de individuos)
\quad
```{r}
dir(dir_GSA1)[2]
  CATNUM.DAT <- read.table(paste(dir_GSA1,dir(dir_GSA1)[2],sep="/"),
                           sep="",na="NA",fill=T,skip = 5)
  CATNUM.DAT 
  
```

### Composiciones de edad


A continuación se presentan los datos de composición por edad. En primer lugar, se establecen las categorías de edad y las definiciones de error de edad.

[Consulte la Guía de usuario de SS3: Sección 7.16 "Age Composition Option"](https://nmfs-stock-synthesis.github.io/doc/SS330_User_Manual.html#age-composition-option).



Datos de error edad
```{r}
# datos de modelo simple
dat$ageerror

# Modificar con los datos propios
dat1$ageerror <- dat$ageerror #data.frame
```

Especificaciones de los datos de composicion de edad
```{r}
# datos de modelo simple
dat$age_info

# Modificar con los datos propios
age_info1<-data.frame(mintailcomp=dat$age_info$mintailcomp,
                      addtocomp=dat$age_info$addtocomp,
                      combine_M_F=dat$age_info$combine_M_F,
                      CompressBins=dat$age_info$CompressBins,
                      CompError=dat$age_info$CompError,
                      ParmSelect=dat$age_info$ParmSelect,
                      minsamplesize=dat$age_info$minsamplesize)

row.names(age_info1)<-c("FISHERY", "SURVEY1", "SURVEY2")

dat1$age_info <- age_info1 #data.frame
```

Datos de composicion de edad
```{r}
# Modificar con los datos propios
new_agecomp_flt_1 <- data.frame(Yr=2002:2021, 
                                Seas=7, 
                                FltSvy=-1, 
                                Gender=3, 
                                Part=0,  
                                Ageerr=2, 
                                Lbin_lo=-1, 
                                Lbin_hi=-1, 
                                Nsamp=75)

new_agecomp_flt_2 <- data.frame(Yr=seq(2002, 2021, by = 3), 
                                Seas=7, 
                                FltSvy=-2, 
                                Gender=3, 
                                Part=0, 
                                Ageerr=2,
                                Lbin_lo=-1, 
                                Lbin_hi=-1, 
                                Nsamp=75)

dat_rows_names <- colnames(dat$agecomp)[-(1:9)]

dat_rows <- as.data.frame(matrix(data = 1, nrow = nrow(new_agecomp_flt_1)+nrow(new_agecomp_flt_2), 
                                 ncol = length(dat_rows_names)))

names(dat_rows) <- dat_rows_names 

new_agecomp  <- rbind(new_agecomp_flt_1, new_agecomp_flt_2)
new_agecomp  <- cbind(new_agecomp, dat_rows)
dat1$agecomp <- rbind(dat$agecomp, new_agecomp) #data.frame
``` 


Otros datos
```{r}
# Modificar con los datos propios
dat1$use_MeanSize_at_Age_obs <- 1 #numeric

MeanSize_at_Age_obs_esp<-data.frame(Yr=dat$MeanSize_at_Age_obs$Yr,
                                    Seas=dat$MeanSize_at_Age_obs$Seas,
                                    FltSvy=dat$MeanSize_at_Age_obs$FltSvy,
                                    Gender=dat$MeanSize_at_Age_obs$Gender,
                                    Part=dat$MeanSize_at_Age_obs$Part,
                                    AgeErr=dat$MeanSize_at_Age_obs$AgeErr,
                                    Ignore=dat$MeanSize_at_Age_obs$Ignore)

MeanSize_at_Age_obs_f   <-dat$MeanSize_at_Age_obs[,8:24]
MeanSize_at_Age_obs_m   <-dat$MeanSize_at_Age_obs[,25:41]
MeanSize_at_Age_obs_N_f <-dat$MeanSize_at_Age_obs[,42:58]

dat_rows_names <-c(colnames(MeanSize_at_Age_obs_esp),colnames(dat$MeanSize_at_Age_obs[1,8:58]))

MeanSize_at_Age_obs1 <-cbind(MeanSize_at_Age_obs_esp,
                              MeanSize_at_Age_obs_f,
                              MeanSize_at_Age_obs_m,
                              MeanSize_at_Age_obs_N_f)

names(MeanSize_at_Age_obs1) <-dat_rows_names 

dat1$MeanSize_at_Age_obs<-MeanSize_at_Age_obs1 #data.frame
```

```{r}
# Modificar con los datos propios
dat1$N_environ_variables    <-0 #numeric
dat1$N_sizefreq_methods     <-0 #numeric
dat1$do_tags                <-0 #numeric
dat1$morphcomp_data         <-0 #numeric
dat1$use_selectivity_priors <-0 #numeric
dat1$eof                    <-TRUE #logical
```

\newpage
# Escribir archivo dat modificado con la función  `SS_write`
```{r eval=F}
r4ss::SS_writedat(dat1,outfile=here(dirname.simple_mod,"data.ss"),overwrite = TRUE)
```


\newpage

#### Peso medio por edad y año de tu matriz de captura (Kilos).
\quad
```{r}
dir(dir_GSA1)[3]
  CATWT.DAT <- read.table(paste(dir_GSA1,dir(dir_GSA1)[3],sep="/"),
                           sep="",na="NA",fill=T,skip = 5)
  CATWT.DAT 
  
```

\newpage

#### Medio por edad y año asumida para el stock (Normalmente = CATWT) (Kilos).
\quad
```{r}
dir(dir_GSA1)[11]
  STOCWT.DAT <- read.table(paste(dir_GSA1,dir(dir_GSA1)[11],sep="/"),
                           sep="",na="NA",fill=T,skip = 5)
  STOCWT.DAT
  
```

\newpage

#### Vector de mortalidad Natural por edad.
\quad
```{r}
dir(dir_GSA1)[7]
  NATMOR.DAT <- read.table(paste(dir_GSA1,dir(dir_GSA1)[7],sep="/"),
                           sep="",na="NA",fill=T,skip = 5)
  NATMOR.DAT
  
```

#### Ogiva de madurez por edad.
\quad
```{r}
dir(dir_GSA1)[10]
  PROPMAT.DAT <- read.table(paste(dir_GSA1,dir(dir_GSA1)[10],sep="/"),
                           sep="",na="NA",fill=T,skip = 5)
  PROPMAT.DAT
  
```

\newpage

### GSA6 (Levante-Norte de España).

\quad
La conceptualización del modelo biológico de **GSA6** considera los siguientes componentes de la dinámica poblacional:

 - Estructura geográfica
 - Reproducción
 - Reclutamiento
 - Mortalidad natural
 - Crecimiento
 - otros...


#### Descripción del modelo
\quad
El modelo de evaluación de stock de **GSA6** se basa en un análisis estadístico de la dinámica de estructuras de edad anual que incorpora información biológica y pesquera. La información que ingresa al modelo consiste en ... 

- Años de evaluación de stock = 2002_2021
- número de edades = 6 años ?

\pagebreak

#### Archivos utilizado para enfoque de modelación `a4a`
\quad
```{r}

dir_GSA6 <-  here("hke_GSA6_a4a_format")
dir(dir_GSA6)

```



#### Capturas anuales del stock (toneladas)
\quad
```{r}
dir(dir_GSA6)[1]
  CATCH.DAT <- read.table(paste(dir_GSA6,dir(dir_GSA6)[1],sep="/"),
                          header=T,sep="",na="NA",fill=T,skip = 4)
  CATCH.DAT
  
```

#### índices de abundancia para calibrar (CPUEs o Campañas, o ambas). Normalmente para índices de campaña empleamos número/KM2.
\quad
```{r}
dir(dir_GSA6)[12]
  TUNEFF.DAT <- read.table(paste(dir_GSA6,dir(dir_GSA6)[12],sep="/"),
                           sep="",na="NA",fill=T,skip = 6)
  TUNEFF.DAT
  
```

#### Matriz de número de individuos por edad/año de las capturas (Miles de individuos)
\quad
```{r}
dir(dir_GSA6)[2]
  CATNUM.DAT <- read.table(paste(dir_GSA6,dir(dir_GSA6)[2],sep="/"),
                           sep="",na="NA",fill=T,skip = 5)
  CATNUM.DAT 
  
```



#### Peso medio por edad y año de tu matriz de captura (Kilos).
\quad
```{r}
dir(dir_GSA6)[3]
  CATWT.DAT <- read.table(paste(dir_GSA6,dir(dir_GSA6)[3],sep="/"),
                           sep="",na="NA",fill=T,skip = 5)
  CATWT.DAT 
  
```

#### Medio por edad y año asumida para el stock (Normalmente = CATWT) (Kilos).
\quad
```{r}
dir(dir_GSA6)[11]
  STOCWT.DAT <- read.table(paste(dir_GSA6,dir(dir_GSA6)[11],sep="/"),
                           sep="",na="NA",fill=T,skip = 5)
  STOCWT.DAT
  
```

#### Vector de mortalidad Natural por edad.
\quad
```{r}
dir(dir_GSA6)[7]
  NATMOR.DAT <- read.table(paste(dir_GSA6,dir(dir_GSA6)[7],sep="/"),
                           sep="",na="NA",fill=T,skip = 5)
  NATMOR.DAT
  
```

#### Ogiva de madurez por edad.
\quad
```{r}
dir(dir_GSA6)[10]
  PROPMAT.DAT <- read.table(paste(dir_GSA6,dir(dir_GSA6)[10],sep="/"),
                           sep="",na="NA",fill=T,skip = 5)
  PROPMAT.DAT
  
```




